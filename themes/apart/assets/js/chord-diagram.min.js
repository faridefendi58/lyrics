var chords=function(){var t="-",r="Arial",e=function(e,i,n,a){var l,o,f,u,c,g,h,s,v,d,w,p,D,S,L,b,m,F,M,x,P,A=function(t,r){return function(){l.strokeStyle=t,l.lineWidth=r,l.lineCap="round"}},C=function(t,r){return function(){l.font=r+"px "+t,l.textBaseline="top"}},W={DrawLine:function(t,r,e,i,n){l.beginPath(),t(),l.moveTo(r,e),l.lineTo(i,n),l.stroke()},FillRectangle:function(t,r,e,i,n){l.beginPath(),l.fillStyle=t,l.rect(r,e,i,n),l.fill()},DrawCircle:function(t,r,e,i){var n=i/2;l.beginPath(),t(),l.arc(r+n,e+n,n,0,2*Math.PI,!1),l.stroke()},FillCircle:function(t,r,e,i){var n=i/2;l.beginPath(),l.fillStyle=t,l.arc(r+n,e+n,n,0,2*Math.PI,!1),l.fill()},MeasureString:function(t,r){r();var e=l.measureText(t);return e.Width=e.width,e},DrawString:function(t,r,e,i,n){r(),l.fillStyle=e,l.fillText(t,i,n)}},y=[],T=[t,t,t,t,t,t],N="#000",X=function(){for(var t=A(N,g),r=c+g,e=0;e<=5;e++){var i=p+e*r;W.DrawLine(t,w,i,w+h-g,i)}for(e=0;e<6;e++){var n=w+e*r;W.DrawLine(t,n,p,n,p+s-g)}if(1==x){var a=c/2;W.FillRectangle(N,w-g/2,p-a,h,a)}},k=function(){for(var r,e={},i=0;i<5;i++)if(-1!=y[i]&&0!=y[i]&&T[i]!=t&&!e.hasOwnProperty(T[i])){r={Str:i,Pos:y[i],Length:0,Finger:T[i]};for(var n=i+1;n<6;n++)T[n]==r.Finger&&y[n]==y[i]&&(r.Length=n-i);r.Length>0&&(e[r.Finger]=r)}var a=A(N,3*g),l=c+g;for(var o in e)if(e.hasOwnProperty(o)){r=e[o];var f=w+r.Str*l,u=f+r.Length*l,h=p+(r.Pos-x+1)*l-l/2;a=A(N,S/2),W.DrawLine(a,f,h,u,h)}},B=function(){for(var t=p-c,r=c+g,e=0;e<y.length;e++){var i=y[e],n=i-x+1,a=w-.5*c+.5*g+e*r;if(n>0){var l=n*r+t;W.FillCircle(N,a,l,S)}else if(0==i){var o=A(N,g),f=(l=p-c,a+(S-M)/2);1==x&&(l-=D),W.DrawCircle(o,f,l,M)}else if(-1==i){o=A(N,1.5*g),l=p-c,f=a+(S-M)/2;1==x&&(l-=D),W.DrawLine(o,f,l,f+M,l+M),W.DrawLine(o,f,l+M,f+M,l)}}},E=function(){for(var e=w+.5*g,i=p+s,n=C(r,b),a=0;a<T.length;a++){var l=T[a];if(l!=t){var o=W.MeasureString(l.toString(),n);W.DrawString(l.toString(),n,N,e-.5*o.Width,i)}e+=c+g}},I=function(){var t,e,i=C(r,m),n=C(r,F);if(-1==f.indexOf("_"))t=f,e="";else{var a=f.split("_");t=a[0],e=a[1]}var l=W.MeasureString(t,i),o=w;if(l.Width<h&&(o=w+(h-l.Width)/2),W.DrawString(t,i,N,o,.2*F),""!=e&&W.DrawString(e,n,N,o+.8*l.Width,0),x>1){var u=C(r,L),g=(L-c)/2;W.DrawString(x+"fr",u,N,w+h+.4*c,p-g)}};return f=null==e||void 0===e?"":e.replace(" ",""),function(t){if(null!=t&&void 0!==t&&t.match(/[\dxX]{6}|((1|2)?[\dxX]-){5}(1|2)?[\dxX]/)){var r;r=t.length>6?t.split("-"):t.split("");for(var e=0,i=Number.MAX_VALUE,n=0;n<6;n++)"X"==r[n].toUpperCase()?y[n]=-1:(y[n]=parseInt(r[n]),e=Math.max(e,y[n]),0!=y[n]&&(i=Math.min(i,y[n])));x=e<=5?1:i}else u=!0}(i),P=n,P=(P=String(P).toUpperCase()+"------").replace(/[^\-T1234]/g,""),T=P.substr(0,6).split(""),o=parseFloat(a),isNaN(o)&&(o=1),function(){D=(c=4*o)/2,g=Math.ceil(.31*o),S=Math.ceil(.9*c),M=.7*c,h=5*c+6*g,s=5*(c+g)+g;L=c/.8,b=.8*c,F=.7*(m=2*c/.8),1==o&&(m+=2,b+=2,L+=2,F+=2),w=c,p=Math.round(.2*F+m+D+1.7*M),v=h+5*c,d=s+p+c+c,.75*c/2}(),{getWidth:function(){return v},getHeight:function(){return d},Draw:function(t){if(l=t,W.FillRectangle("#FFF",0,0,v,d),u){var r=A("red",3);W.DrawLine(r,0,0,v,d),W.DrawLine(r,0,d,v,0)}else X(),B(),I(),E(),k()}}};return{chord:e,replace:function(){for(var t=document.getElementsByTagName("chord"),r=0;r<t.length;++r){var i=t[r],n=i.getAttribute("name"),a=i.getAttribute("positions"),l=i.getAttribute("fingers"),o=i.getAttribute("size"),f=e(n,a,l,o),u=document.createElement("canvas");u.setAttribute("width",f.getWidth()),u.setAttribute("height",f.getHeight()),i.parentNode.insertBefore(u,i);var c=u.getContext("2d");f.Draw(c)}}}}();